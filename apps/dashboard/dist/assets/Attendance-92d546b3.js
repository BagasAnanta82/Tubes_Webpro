var O=Object.defineProperty;var M=(r,l,s)=>l in r?O(r,l,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[l]=s;var b=(r,l,s)=>(M(r,typeof l!="symbol"?l+"":l,s),s);import{d as $,r as c,i as K,o as H,j as f,q as w,w as A,a as h,b as I,c as T,e as n,f as t,k as o,l as v,t as V,F as R}from"./index-655b1c19.js";import{C as W}from"./ClassroomService-4911a0c7.js";class j{constructor(){b(this,"url");b(this,"token");this.url="https://api-sman24dev.matradipti.org/api/v1/",this.token=JSON.parse(window.localStorage.getItem("token")).token}getStudentAttendences(l=new Date().toISOString(),s=null){return fetch(`${this.url}attandence/records?date_at=${l}&classroom_id=${s}`,{method:"GET",headers:{Authorization:`Bearer ${this.token}`}}).then(m=>m.json()).then(m=>m.data)}}const E={class:"card"},L=n("h1",null,"Rekam Presensi SMAN24 Bandung",-1),q={class:"grid mt-4"},z={class:"col-12 lg:col-6"},G=n("h5",null,"Silahkan Pilih Tanggal Presnesi",-1),J={class:"col-12 lg:col-6"},Q=n("h5",null,"Kelas",-1),X={className:"card"},Y={class:"flex justify-content-between flex-column sm:flex-row"},Z={class:"text-align-left gap-2"},ee={class:"p-input-icon-left mb-2"},te=n("i",{class:"pi pi-search"},null,-1),le={key:0},ae={key:1},de=$({__name:"Attendance",setup(r){const l=c(null),s=c(null),m=c(null),_=c(null),D=c(!0),y=c(null),k=c(null),N=new j,U=new W;K(()=>{D.value=!1,x()}),H(()=>{N.getStudentAttendences().then(u=>l.value=u),U.getAllClassroom().then(u=>m.value=u)});const x=()=>{_.value={global:{value:null,matchMode:f.CONTAINS},name:{operator:w.AND,constraints:[{value:null,matchMode:f.STARTS_WITH}]},NIS:{operator:w.AND,constraints:[{value:null,matchMode:f.STARTS_WITH}]},NISN:{operator:w.AND,constraints:[{value:null,matchMode:f.STARTS_WITH}]}}},B=()=>{x()},F=()=>{k.value.exportCSV()};return A(y,async(u,a)=>{const d=new Date(u);d.setDate(d.getDate()+1),await N.getStudentAttendences(d.toISOString()).then(S=>l.value=S)}),A(s,async(u,a)=>{const d=new Date(y);d.setDate(d.getDate()+1),await N.getStudentAttendences(d.toISOString(),u.id).then(S=>l.value=S)}),(u,a)=>{const d=h("Calendar"),S=h("Dropdown"),C=h("Button"),p=h("InputText"),g=h("Column"),P=h("DataTable");return I(),T(R,null,[n("div",E,[L,n("div",q,[n("div",z,[G,t(d,{id:"date",modelValue:y.value,"onUpdate:modelValue":a[0]||(a[0]=e=>y.value=e),style:{width:"70%"}},null,8,["modelValue"])]),n("div",J,[Q,t(S,{modelValue:s.value,"onUpdate:modelValue":a[1]||(a[1]=e=>s.value=e),options:m.value,optionLabel:"name",placeholder:"Silah Pilih Kelas"},null,8,["modelValue","options"])])])]),n("div",X,[t(P,{ref_key:"dt",ref:k,value:l.value,paginator:!0,class:"p-datatable-gridlines",rows:20,dataKey:"id",rowHover:!0,rowsPerPageOptions:[20,50,75,100],filters:_.value,"onUpdate:filters":a[5]||(a[5]=e=>_.value=e),filterDisplay:"menu",loading:D.value,responsiveLayout:"scroll",globalFilterFields:["name","NIS","NISN"]},{header:o(()=>[n("div",Y,[n("div",Z,[t(C,{type:"button",icon:"pi pi-filter-slash",label:"Clear",class:"p-button-outlined mb-2",onClick:a[2]||(a[2]=e=>B())}),t(C,{type:"button",icon:"pi pi-upload",label:"Export",class:"p-button-outlined mb-2",onClick:a[3]||(a[3]=e=>F())})]),n("span",ee,[te,t(p,{modelValue:_.value.global.value,"onUpdate:modelValue":a[4]||(a[4]=e=>_.value.global.value=e),placeholder:"Keyword Search",style:{width:"100%"}},null,8,["modelValue"])])])]),empty:o(()=>[v(" Data Tidak Ditemukan. ")]),loading:o(()=>[v(" Memuat Data Presensi, Mohon Tunggu. ")]),default:o(()=>[t(g,{field:"name",header:"Name",style:{"min-width":"12rem"}},{body:o(({data:e})=>[v(V(e.name),1)]),filter:o(({filterModel:e})=>[t(p,{type:"text",modelValue:e.value,"onUpdate:modelValue":i=>e.value=i,class:"p-column-filter",placeholder:"Search by name"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(g,{field:"NISN",header:"NISN",style:{"min-width":"12rem"}},{body:o(({data:e})=>[v(V(e.NISN),1)]),filter:o(({filterModel:e})=>[t(p,{type:"text",modelValue:e.value,"onUpdate:modelValue":i=>e.value=i,class:"p-column-filter",placeholder:"Search by NISN"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(g,{field:"gender",header:"Kelamin",style:{"min-width":"12rem"}},{body:o(({data:e})=>[v(V(e.code),1)]),filter:o(({filterModel:e})=>[t(p,{type:"text",modelValue:e.value,"onUpdate:modelValue":i=>e.value=i,class:"p-column-filter",placeholder:"Search by NISN"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(g,{field:"timestamp",header:"timestamp",style:{"min-width":"12rem"}},{body:o(({data:e})=>[v(V(e.timestamp),1)]),filter:o(({filterModel:e})=>[t(p,{type:"text",modelValue:e.value,"onUpdate:modelValue":i=>e.value=i,class:"p-column-filter",placeholder:"Search by NISN"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(g,{field:"is_late",header:"Status",style:{"min-width":"12rem"}},{body:o(({data:e})=>[e.is_late==!0?(I(),T("div",le," Terlambat ")):(I(),T("div",ae," Tepat Waktu "))]),filter:o(({filterModel:e})=>[t(p,{type:"text",modelValue:e.value,"onUpdate:modelValue":i=>e.value=i,class:"p-column-filter",placeholder:"Search by NISN"},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["value","filters","loading"])])],64)}}});export{de as default};

var O=Object.defineProperty;var P=(m,t,n)=>t in m?O(m,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):m[t]=n;var V=(m,t,n)=>(P(m,typeof t!="symbol"?t+"":t,n),n);import{d as $,r as p,i as M,o as R,j as b,q as N,w as A,a as v,b as x,c as T,e as s,f as l,k as o,l as _,t as w,F as K}from"./index-61519010.js";import{C as j}from"./ClassroomService-4484b5fa.js";class H{constructor(){V(this,"url");V(this,"token");this.url="https://api-sman24dev.matradipti.org/api/v1/",this.token=JSON.parse(window.localStorage.getItem("token")).token}getStudentAttendences(t=new Date().toISOString(),n=null){return fetch(`${this.url}attandence/records?date_at=${t}&classroom_id=${n}`,{method:"GET",headers:{Authorization:`Bearer ${this.token}`}}).then(u=>u.json()).then(u=>u.data)}async getStudentAttendencesExcelExport(){const t=await fetch(`${this.url}excel/attandence`,{method:"GET",headers:{Authorization:`Bearer ${this.token}`}}).then(d=>d.arrayBuffer()).then(d=>d),n=new File([t],"filename.xlsx",{type:"application/vnd.ms-excel"}),u=URL.createObjectURL(n);window.open(u)}}const L={class:"card"},W=s("h1",null,"Rekam Presensi SMAN24 Bandung",-1),z={class:"grid mt-4"},G={class:"col-12 lg:col-6"},q=s("h5",null,"Silahkan Pilih Tanggal Presnesi",-1),J={class:"col-12 lg:col-6"},Q=s("h5",null,"Kelas",-1),X={className:"card"},Y={class:"flex justify-content-between flex-column sm:flex-row"},Z={class:"text-align-left gap-2"},ee={class:"p-input-icon-left mb-2"},te=s("i",{class:"pi pi-search"},null,-1),le={key:0},ae={key:1},de=$({__name:"Attendance",setup(m){const t=p(null),n=p(null),u=p(null),d=p(null),I=p(!0),f=p(null),C=p(null),g=new H,U=new j;M(()=>{I.value=!1,D()}),R(()=>{g.getStudentAttendences().then(c=>t.value=c),U.getAllClassroom().then(c=>u.value=c)});const D=()=>{d.value={global:{value:null,matchMode:b.CONTAINS},name:{operator:N.AND,constraints:[{value:null,matchMode:b.STARTS_WITH}]},NIS:{operator:N.AND,constraints:[{value:null,matchMode:b.STARTS_WITH}]},NISN:{operator:N.AND,constraints:[{value:null,matchMode:b.STARTS_WITH}]}}},B=()=>{D()},F=async()=>{await g.getStudentAttendencesExcelExport()};return A(f,async(c,a)=>{const i=new Date(c);i.setDate(i.getDate()+1),await g.getStudentAttendences(i.toISOString()).then(S=>t.value=S)}),A(n,async(c,a)=>{const i=new Date(f);i.setDate(i.getDate()+1),await g.getStudentAttendences(i.toISOString(),c.id).then(S=>t.value=S)}),(c,a)=>{const i=v("Calendar"),S=v("Dropdown"),k=v("Button"),h=v("InputText"),y=v("Column"),E=v("DataTable");return x(),T(K,null,[s("div",L,[W,s("div",z,[s("div",G,[q,l(i,{id:"date",modelValue:f.value,"onUpdate:modelValue":a[0]||(a[0]=e=>f.value=e),style:{width:"70%"}},null,8,["modelValue"])]),s("div",J,[Q,l(S,{modelValue:n.value,"onUpdate:modelValue":a[1]||(a[1]=e=>n.value=e),options:u.value,optionLabel:"name",placeholder:"Silah Pilih Kelas"},null,8,["modelValue","options"])])])]),s("div",X,[l(E,{ref_key:"dt",ref:C,value:t.value,paginator:!0,class:"p-datatable-gridlines",rows:20,dataKey:"id",rowHover:!0,rowsPerPageOptions:[20,50,75,100],filters:d.value,"onUpdate:filters":a[5]||(a[5]=e=>d.value=e),filterDisplay:"menu",loading:I.value,responsiveLayout:"scroll",globalFilterFields:["name","NIS","NISN"]},{header:o(()=>[s("div",Y,[s("div",Z,[l(k,{type:"button",icon:"pi pi-filter-slash",label:"Clear",class:"p-button-outlined mb-2",onClick:a[2]||(a[2]=e=>B())}),l(k,{type:"button",icon:"pi pi-upload",label:"Export",class:"p-button-outlined mb-2",onClick:a[3]||(a[3]=e=>F())})]),s("span",ee,[te,l(h,{modelValue:d.value.global.value,"onUpdate:modelValue":a[4]||(a[4]=e=>d.value.global.value=e),placeholder:"Keyword Search",style:{width:"100%"}},null,8,["modelValue"])])])]),empty:o(()=>[_(" Data Tidak Ditemukan. ")]),loading:o(()=>[_(" Memuat Data Presensi, Mohon Tunggu. ")]),default:o(()=>[l(y,{field:"name",header:"Name",style:{"min-width":"12rem"}},{body:o(({data:e})=>[_(w(e.name),1)]),filter:o(({filterModel:e})=>[l(h,{type:"text",modelValue:e.value,"onUpdate:modelValue":r=>e.value=r,class:"p-column-filter",placeholder:"Search by name"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(y,{field:"NISN",header:"NISN",style:{"min-width":"12rem"}},{body:o(({data:e})=>[_(w(e.NISN),1)]),filter:o(({filterModel:e})=>[l(h,{type:"text",modelValue:e.value,"onUpdate:modelValue":r=>e.value=r,class:"p-column-filter",placeholder:"Search by NISN"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(y,{field:"gender",header:"Kelamin",style:{"min-width":"12rem"}},{body:o(({data:e})=>[_(w(e.code),1)]),filter:o(({filterModel:e})=>[l(h,{type:"text",modelValue:e.value,"onUpdate:modelValue":r=>e.value=r,class:"p-column-filter",placeholder:"Search by NISN"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(y,{field:"timestamp",header:"timestamp",style:{"min-width":"12rem"}},{body:o(({data:e})=>[_(w(e.timestamp),1)]),filter:o(({filterModel:e})=>[l(h,{type:"text",modelValue:e.value,"onUpdate:modelValue":r=>e.value=r,class:"p-column-filter",placeholder:"Search by NISN"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(y,{field:"is_late",header:"Status",style:{"min-width":"12rem"}},{body:o(({data:e})=>[e.is_late==!0?(x(),T("div",le," Terlambat ")):(x(),T("div",ae," Tepat Waktu "))]),filter:o(({filterModel:e})=>[l(h,{type:"text",modelValue:e.value,"onUpdate:modelValue":r=>e.value=r,class:"p-column-filter",placeholder:"Search by NISN"},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["value","filters","loading"])])],64)}}});export{de as default};

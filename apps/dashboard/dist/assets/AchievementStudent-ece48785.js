var ee=Object.defineProperty;var te=(_,n,i)=>n in _?ee(_,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):_[n]=i;var V=(_,n,i)=>(te(_,typeof n!="symbol"?n+"":n,i),i);import{d as ae,h as se,r,i as le,o as ne,j as E,a as v,b as g,c as y,e as a,f as t,k as l,l as u,t as c,F as ie,p as oe,m as T}from"./index-50b5eccf.js";import{S as de}from"./SiswaService-20a043ea.js";import{A as re}from"./AchievementService-ccdfbfa4.js";class ue{constructor(){V(this,"url");V(this,"token");this.url="https://api-smktelkombandung.matradipti.org/api/v1/",this.token=JSON.parse(window.localStorage.getItem("token")).token}getAllStudentAchievement(){return fetch(`${this.url}achievements/student`,{method:"GET",headers:{Authorization:`Bearer ${this.token}`}}).then(n=>n.json()).then(n=>n.data)}getStudentAchievementById(n){return fetch(`${this.url}achievements/student/${n}`,{method:"GET",headers:{Authorization:`Bearer ${this.token}`}}).then(i=>i.json()).then(i=>i.data)}createStudentAchievement(n){return fetch(`${this.url}achievements/student`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${this.token}`},body:JSON.stringify({achievement_id:n.achievement.id,description:n.description,students:n.students})}).then(i=>i.json()).then(i=>i)}deleteStudentAchievement(n){return fetch(`${this.url}achievements/student`,{method:"DELETE",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${this.token}`},body:JSON.stringify({id:n})}).then(i=>i.json()).then(i=>i)}async getStudentAchievementExcelExport(){const n=await fetch(`${this.url}excel/achievement`,{method:"GET",headers:{Authorization:`Bearer ${this.token}`}}).then(h=>h.arrayBuffer()).then(h=>h),i=new File([n],"filename.xlsx",{type:"application/vnd.ms-excel"}),k=URL.createObjectURL(i);window.open(k)}}const ce={class:"grid"},me={class:"col-12"},pe={class:"card"},he={class:"my-2"},ve={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},fe=a("h5",{class:"m-0"},"Data Siswa SMAN 24 Bandung",-1),_e={class:"block mt-2 md:mt-0 p-input-icon-left"},be=a("i",{class:"pi pi-search"},null,-1),ge=a("span",{class:"p-column-title"},"Name",-1),ye=a("span",{class:"p-column-title"},"NIS",-1),Se=a("span",{class:"p-column-title"},"NISN",-1),we=a("span",{class:"p-column-title"},"kelamin",-1),ke=a("span",{class:"p-column-title"},"Kelas",-1),xe={class:"field"},Ne=a("label",{for:"inventoryStatus",class:"mb-3"},"Pencapaian",-1),Pe={class:"field"},Ae=a("label",{for:"multipleStatus",class:"mb-3"},"Pencapaian",-1),Ce={key:0,class:"p-1"},De={class:"flex align-items-center"},Te={class:"field"},Be=a("label",{for:"description"},"Deskripsi",-1),Le={class:"flex align-items-center justify-content-center"},Ve=a("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),Ie={key:0},Ue={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},Me=a("h5",{class:"m-0"},"Data Pencapaian SMAN 24",-1),$e={class:"block mt-2 md:mt-0 p-input-icon-left"},je=a("i",{class:"pi pi-search"},null,-1),Ee=a("span",{class:"p-column-title"},"Name",-1),Re=a("span",{class:"p-column-title"},"Code",-1),Ge=a("span",{class:"p-column-title"},"Deskripsi",-1),Oe=a("span",{class:"p-column-title"},"Nilai",-1),ze=a("span",{class:"p-column-title"},"Nilai",-1),Fe={class:"flex align-items-center justify-content-center"},Ke=a("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),Ye={key:0},Je={class:"flex align-items-center justify-content-center"},qe=a("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),He={key:0},et=ae({__name:"AchievementStudent",setup(_){const n=se(),i=r(null),k=r({}),h=r({}),S=r(!1),x=r(!1);r(!1);const f=r(!1),N=r(!1),o=r({}),P=r(null),I=r(null),A=r({}),C=r({}),B=r(!1),L=r(!0),R=new de,G=new re,b=new ue;le(()=>{q()}),ne(()=>{R.getAllStudentData().then(d=>i.value=d),G.getAllAchievement().then(d=>k.value=d),L.value=!1});const O=()=>{o.value={},B.value=!1,S.value=!0},U=()=>{S.value=!1,x.value=!1,h.value={},B.value=!1},z=async()=>{B.value=!0,await b.createStudentAchievement(o.value).then(d=>{d.status?n.add({severity:"success",summary:"Berhasil",detail:"Berhasil Tambah Siswa",life:3e3}):n.add({severity:"error",summary:"Gagal",detail:"Gagal Untuk Membuat Data Siswa",life:3e3})}),S.value=!1,o.value={}},F=async d=>{await b.getStudentAchievementById(d.student_id).then(s=>{h.value.student=s.student,h.value.score=s.total_score}),x.value=!0},K=d=>{o.value=d,f.value=!0},M=async()=>{f.value=!1,await b.deleteStudentAchievement(o.value.id).then(d=>d.status?n.add({severity:"success",summary:"Successful",detail:"berhasil menghapus data",life:3e3}):n.add({severity:"error",summary:"Gagal",detail:"Gagal Menghapus data siswa",life:3e3})),await b.getStudentAchievementById(o.value.student_id).then(d=>h.value=d),o.value={}},Y=async()=>{await b.getStudentAchievementExcelExport()},J=async()=>{await b.deleteStudentAchievement(P.value).then(d=>d.status?n.add({severity:"success",summary:"Berhasil",detail:"Siswa Terhapus",life:3e3}):n.add({severity:"error",summary:"Gagal",detail:"Siswa Gagal Terhapus",life:3e3})),await b.getStudentAchievementById().then(d=>i.value=d),N.value=!1,P.value=null},q=()=>{A.value={global:{value:null,matchMode:E.CONTAINS}},C.value={global:{value:null,matchMode:E.CONTAINS}}};return(d,s)=>{const H=v("Toast"),m=v("Button"),Q=v("Toolbar"),$=v("InputText"),p=v("Column"),j=v("DataTable"),W=v("Dropdown"),X=v("MultiSelect"),Z=v("Textarea"),w=v("Dialog");return g(),y("div",ce,[a("div",me,[a("div",pe,[t(H),t(Q,{class:"mb-4"},{start:l(()=>[a("div",he,[t(m,{label:"New",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:O})])]),end:l(()=>[t(m,{label:"Export",icon:"pi pi-upload",class:"p-button-help",onClick:s[0]||(s[0]=e=>Y(e))})]),_:1}),t(j,{ref_key:"dt",ref:I,value:i.value,dataKey:"id",paginator:!0,rows:20,filters:A.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[20,50,100],loading:L.value,currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} students",responsiveLayout:"scroll"},{header:l(()=>[a("div",ve,[fe,a("span",_e,[be,t($,{modelValue:A.value.global.value,"onUpdate:modelValue":s[1]||(s[1]=e=>A.value.global.value=e),placeholder:"Search..."},null,8,["modelValue"])])])]),default:l(()=>[t(p,{field:"name",header:"Name",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:l(e=>[ge,u(" "+c(e.data.name),1)]),_:1}),t(p,{field:"NIS",header:"NIS",sortable:!0,headerStyle:"width:14%; min-width:8rem;"},{body:l(e=>[ye,u(" "+c(e.data.NIS),1)]),_:1}),t(p,{field:"NISN",header:"NISN",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:l(e=>[Se,u(" "+c(e.data.NISN),1)]),_:1}),t(p,{field:"code",header:"Kelamin",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:l(e=>[we,u(" "+c(e.data.code),1)]),_:1}),t(p,{field:"classroom_name",header:"Kelas",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:l(e=>[ke,u(" "+c(e.data.classroom_name),1)]),_:1}),t(p,{header:"action",headerStyle:"min-width:10rem;"},{body:l(e=>[t(m,{icon:"pi pi-search",class:"p-button-rounded p-button-primary mr-2",onClick:D=>F(e.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","filters","loading"]),t(w,{visible:S.value,"onUpdate:visible":s[5]||(s[5]=e=>S.value=e),style:{width:"450px"},header:"Penambahan Data Pencapaian Siswa",modal:!0,class:"p-fluid"},{footer:l(()=>[t(m,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:U}),t(m,{label:"Save",icon:"pi pi-check",class:"p-button-text",onClick:z})]),default:l(()=>[a("div",xe,[Ne,t(W,{id:"inventoryStatus",modelValue:o.value.achievement,"onUpdate:modelValue":s[2]||(s[2]=e=>o.value.achievement=e),options:k.value,optionLabel:"name"},null,8,["modelValue","options"])]),a("div",Pe,[Ae,t(X,{id:"multipleStatus",modelValue:o.value.students,"onUpdate:modelValue":s[3]||(s[3]=e=>o.value.students=e),options:i.value,optionLabel:"name",placeholder:"Pilih Siswa",filter:!0},{value:l(e=>[(g(!0),y(ie,null,oe(e.value,D=>(g(),y("div",{class:"inline-flex align-items-center py-1 px-2 bg-primary text-primary border-round mr-2",key:D.id},[a("div",null,c(D.name),1)]))),128)),!e.value||e.value.length===0?(g(),y("div",Ce,"Pilih Siswa")):T("",!0)]),option:l(e=>[a("div",De,[a("div",null,c(e.option.name),1)])]),_:1},8,["modelValue","options"])]),a("div",Te,[Be,t(Z,{id:"description",modelValue:o.value.description,"onUpdate:modelValue":s[4]||(s[4]=e=>o.value.description=e),modelModifiers:{trim:!0},required:!0,autofocus:""},null,8,["modelValue"])])]),_:1},8,["visible"]),t(w,{visible:f.value,"onUpdate:visible":s[7]||(s[7]=e=>f.value=e),style:{width:"450px"},header:"Confirm",modal:!0},{footer:l(()=>[t(m,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:s[6]||(s[6]=e=>f.value=!1)}),t(m,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:M})]),default:l(()=>[a("div",Le,[Ve,o.value?(g(),y("span",Ie,[u("Apakah Anda Yakin Untuk Menghapus Siswa "),a("b",null,c(o.value.name),1),u("?")])):T("",!0)])]),_:1},8,["visible"]),t(w,{visible:x.value,"onUpdate:visible":s[10]||(s[10]=e=>x.value=e),style:{width:"950px"},header:"Data Pencapaian",modal:!0,class:"p-fluid"},{footer:l(()=>[t(m,{label:"Close",icon:"pi pi-times",class:"p-button-text",onClick:U})]),default:l(()=>[t(j,{ref_key:"dt",ref:I,value:h.value.student,selection:P.value,"onUpdate:selection":s[9]||(s[9]=e=>P.value=e),dataKey:"id",paginator:!0,rows:5,filters:C.value,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,15],loading:L.value,currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} students",responsiveLayout:"scroll"},{header:l(()=>[a("div",Ue,[Me,a("span",$e,[je,t($,{modelValue:C.value.global.value,"onUpdate:modelValue":s[8]||(s[8]=e=>C.value.global.value=e),placeholder:"Search..."},null,8,["modelValue"])])])]),footer:l(()=>[u("Total Score "+c(h.value.score),1)]),default:l(()=>[t(p,{field:"achievement_name",header:"Name",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:l(e=>[Ee,u(" "+c(e.data.achievement_name),1)]),_:1}),t(p,{field:"achievement_code",header:"Kode Pencapaian",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:l(e=>[Re,u(" "+c(e.data.achievement_code),1)]),_:1}),t(p,{field:"achievement_code",header:"Deskripsi",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:l(e=>[Ge,u(" "+c(e.data.description),1)]),_:1}),t(p,{field:"achievement_score",header:"Nilai",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:l(e=>[Oe,u(" "+c(e.data.achievement_score),1)]),_:1}),t(p,{field:"timestamp",header:"Timestamp",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:l(e=>[ze,u(" "+c(e.data.timestamp),1)]),_:1}),t(p,{header:"action",headerStyle:"min-width:10rem;"},{body:l(e=>[t(m,{icon:"pi pi-trash",class:"p-button-rounded p-button-warning mt-2",onClick:D=>K(e.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","selection","filters","loading"])]),_:1},8,["visible"]),t(w,{visible:f.value,"onUpdate:visible":s[12]||(s[12]=e=>f.value=e),style:{width:"450px"},header:"Confirm",modal:!0},{footer:l(()=>[t(m,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:s[11]||(s[11]=e=>f.value=!1)}),t(m,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:M})]),default:l(()=>[a("div",Fe,[Ke,o.value?(g(),y("span",Ye,[u("Apakah Anda Yakin Untuk Menghapus Siswa "),a("b",null,c(o.value.name),1),u("?")])):T("",!0)])]),_:1},8,["visible"]),t(w,{visible:N.value,"onUpdate:visible":s[14]||(s[14]=e=>N.value=e),style:{width:"450px"},header:"Confirm",modal:!0},{footer:l(()=>[t(m,{label:"No",icon:"pi pi-times",class:"p-button-text",onClick:s[13]||(s[13]=e=>N.value=!1)}),t(m,{label:"Yes",icon:"pi pi-check",class:"p-button-text",onClick:J})]),default:l(()=>[a("div",Je,[qe,o.value?(g(),y("span",He,"Apakah Anda Yakin Untuk Menghapus Data-Data Siswa?")):T("",!0)])]),_:1},8,["visible"])])])])}}});export{et as default};
